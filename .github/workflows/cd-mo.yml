name: cd of springpetclinic
on:
  workflow_dispatch: 
    inputs:
      environment:
        description: "choose environment"
        required: true
        default: "staging"
jobs:
  terraform:
    runs-on: ubuntu-latest

    steps:
        - name: checkout repository
          uses: actions/checkout@v4

        - name: aws credntials
          uses: aws-actions/configure-aws-credentials@a03048d87541d1d9fcf2ecf528a4a65ba9bd7838
          with:
            aws-region: eu-central-1
            aws-access-key-id: ${{ secrets.AWS_GITHUB_ACTIONS_ID }}
            aws-secret-access-key: ${{ secrets.AWS_GITHUB_ACTIONS_SECRET }}
          
        - name: Run command on EC2
          run: |
            aws ssm send-command \
            --targets "Key=instanceIds,Values=i-07568d2206758600b" \
            --document-name "AWS-RunShellScript" \
            --parameters 'commands=["apt-get install nginx -y "]'
